<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Kh√°ch h√†ng - Trang ch·ªß</title>
    <meta charset="UTF-8">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">

<div class="container mt-5">

    <!-- Header -->
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h2>Ch√†o m·ª´ng b·∫°n ƒë·∫øn v·ªõi c·ª≠a h√†ng!</h2>
        <a href="/logout" class="btn btn-danger">ƒêƒÉng xu·∫•t</a>
    </div>

    <!-- Danh s√°ch s·∫£n ph·∫©m -->
    <h4 class="mb-3">Danh s√°ch s·∫£n ph·∫©m</h4>

    <div class="row row-cols-1 row-cols-md-3 g-4" th:if="${products != null}">
        <div class="col" th:each="product : ${products}">
            <div class="card h-100 shadow-sm">
                <div class="card-body">
                    <h5 class="card-title text-primary" th:text="${product.productName}">T√™n s·∫£n ph·∫©m</h5>
                    <p class="card-text" th:text="${product.description}">M√¥ t·∫£</p>
                </div>
                <div class="card-footer bg-white border-top-0 d-flex justify-content-between align-items-center">
                    <span class="text-success fw-bold" th:text="${product.price} + ' VNƒê'">0 VNƒê</span>

                    <!-- N√∫t ‚ûï ƒë·ªè -->
                    <form th:action="@{/cart/add}" method="post" class="d-inline">
                        <input type="hidden" name="productId" th:value="${product.id}" />
                        <button type="submit" class="btn btn-sm btn-danger">+</button>
                    </form>

                    <!-- N√∫t Mua ngay -->
                    <form th:action="@{/buy}" method="post" class="d-inline">
                        <input type="hidden" name="productId" th:value="${product.id}" />
                        <button type="submit" class="btn btn-sm btn-success">Mua</button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Th√¥ng b√°o n·∫øu kh√¥ng c√≥ s·∫£n ph·∫©m -->
    <div th:if="${products == null or products.isEmpty()}" class="alert alert-info mt-3">
        Hi·ªán t·∫°i ch∆∞a c√≥ s·∫£n ph·∫©m n√†o.
    </div>

    <!-- Gi·ªè h√†ng t·ªïng -->
    <h4 class="mt-5">üß∫ Gi·ªè h√†ng c·ªßa b·∫°n</h4>

    <div class="table-responsive" th:if="${cart != null and !cart.isEmpty()}">
        <table class="table table-bordered">
            <thead class="table-light">
                <tr>
                    <th>T√™n s·∫£n ph·∫©m</th>
                    <th>S·ªë l∆∞·ª£ng</th>
                    <th>Gi√°</th>
                    <th>Th√†nh ti·ªÅn</th>
                    <th>Thao t√°c</th>
                </tr>
            </thead>
            <tbody>
                <tr th:each="item : ${cart}">
                    <td th:text="${item.product.productName}">T√™n s·∫£n ph·∫©m</td>
                    <td th:text="${item.quantity}">1</td>
                    <td th:text="${item.product.price} + ' VNƒê'">0 VNƒê</td>
                    <td th:text="${item.product.price * item.quantity} + ' VNƒê'">0 VNƒê</td>
                    <td>
                        <form th:action="@{/cart/remove}" method="post">
                            <input type="hidden" name="productId" th:value="${item.product.id}" />
                            <button type="submit" class="btn btn-sm btn-danger">üóë</button>
                        </form>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>

    <div th:if="${cart == null or cart.isEmpty()}" class="alert alert-secondary mt-3">
        Gi·ªè h√†ng c·ªßa b·∫°n ƒëang tr·ªëng.
    </div>

    <!-- N√∫t mua to√†n b·ªô -->
    <form th:action="@{/checkout}" method="post" class="mt-3" th:if="${cart != null and !cart.isEmpty()}">
        <button type="submit" class="btn btn-success">üßæ Mua h√†ng</button>
    </form>

</div>

</body>
</html>
